<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lava Jato do Di</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Cabeçalho -->
  <header>
    <img src="logo.png" alt="Logo Lava Jato" class="logo">
    <h1>Lava Jato do Di 🚗🧼</h1>
    <button id="toggleTema" class="tema-btn">🌙</button>
  </header>

  <!-- Conteúdo principal -->
  <main>
    <!-- Formulário -->
    <div class="formulario">
      <input id="funcionario" placeholder="Nome do funcionário">
      <select id="veiculo">
        <option value="carro">Carro</option>
        <option value="moto">Moto</option>
        <option value="caminhao">Caminhão</option>
      </select>
      <button id="btnAdicionar">Adicionar</button>
    </div>

    <!-- Registros -->
    <section>
      <h2>Registros</h2>
      <ul id="listaRegistros"></ul>
    </section>

    <!-- Ganhos -->
    <section>
      <h2>Ganhos por Funcionário</h2>
      <ul id="listaGanhos"></ul>
    </section>

    <!-- Resumo com ícones -->
    <section>
      <h2>Resumo do Dia</h2>
      <ul id="resumoDia">
        <li><span class="icon">🚗</span> Carros: <span id="totalCarros">0</span></li>
        <li><span class="icon">🏍️</span> Motos: <span id="totalMotos">0</span></li>
        <li><span class="icon">🚚</span> Caminhões: <span id="totalCaminhoes">0</span></li>
      </ul>
    </section>
  </main>

  <!-- Login do dono -->
  <div class="login-dono" id="loginDono">
    <input type="password" id="senhaDono" placeholder="Senha do dono">
    <button id="btnLoginDono">Entrar</button>
  </div>

  <!-- Painel do dono moderno -->
  <div class="painel" id="painelDono">
    <div class="painel-header">
      <span>Painel do Dono</span>
      <button id="btnLogoutDono">❌</button>
    </div>

    <div class="abas">
      <button id="abaHistoricoBtn">Histórico</button>
      <button id="abaGraficoBtn">Gráfico</button>
    </div>

    <div class="aba-conteudo" id="aba-historico">
      <ul id="historicoRegistros"></ul>
    </div>

    <div class="aba-conteudo" id="aba-grafico" style="display:none;">
      <canvas id="graficoHistorico"></canvas>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const valores = { carro: 20, moto: 10, caminhao: 50 };
      let registros = [];
      let historico = [];
      const senhaCorreta = "1234";

      // Elementos
      const listaRegistros = document.getElementById("listaRegistros");
      const listaGanhos = document.getElementById("listaGanhos");
      const totalCarros = document.getElementById("totalCarros");
      const totalMotos = document.getElementById("totalMotos");
      const totalCaminhoes = document.getElementById("totalCaminhoes");
      const historicoUl = document.getElementById("historicoRegistros");

      const painelDono = document.getElementById("painelDono");
      const loginDonoDiv = document.getElementById("loginDono");

      const toggleBtn = document.getElementById("toggleTema");

      // Tema salvo
      const temaSalvo = localStorage.getItem("tema");
      if (temaSalvo === "dark") {
        document.body.classList.add("dark");
        toggleBtn.textContent = "🌙";
      } else {
        document.body.classList.remove("dark");
        toggleBtn.textContent = "☀️";
      }

      toggleBtn.addEventListener("click", () => {
        document.body.classList.toggle("dark");
        if (document.body.classList.contains("dark")) {
          toggleBtn.textContent = "🌙";
          localStorage.setItem("tema", "dark");
        } else {
          toggleBtn.textContent = "☀️";
          localStorage.setItem("tema", "light");
        }
      });

      // Chart.js
      const ctx = document.getElementById("graficoHistorico").getContext("2d");
      const grafico = new Chart(ctx, {
        type: "bar",
        data: {
          labels: [],
          datasets: [
            { label: "Lavagens Carro", data: [], backgroundColor: "#00bfff" },
            { label: "Lavagens Moto", data: [], backgroundColor: "#ffb400" },
            { label: "Lavagens Caminhão", data: [], backgroundColor: "#ff4d4d" }
          ]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
      });

      function atualizarTela() {
        // Registros
        listaRegistros.innerHTML = "";
        registros.forEach(r => {
          const li = document.createElement("li");
          li.textContent = `${r.funcionario} lavou um ${r.veiculo} (+R$ ${valores[r.veiculo]})`;
          listaRegistros.appendChild(li);
        });

        // Ganhos
        const ganhos = registros.reduce((acc, r) => {
          acc[r.funcionario] = (acc[r.funcionario] || 0) + valores[r.veiculo];
          return acc;
        }, {});
        listaGanhos.innerHTML = "";
        for (const [nome, total] of Object.entries(ganhos)) {
          const li = document.createElement("li");
          li.textContent = `${nome}: R$ ${total}`;
          listaGanhos.appendChild(li);
        }

        // Resumo
        const resumo = { carro: 0, moto: 0, caminhao: 0 };
        registros.forEach(r => resumo[r.veiculo]++);
        totalCarros.textContent = resumo.carro;
        totalMotos.textContent = resumo.moto;
        totalCaminhoes.textContent = resumo.caminhao;

        // Histórico
        historicoUl.innerHTML = "";
        historico.forEach(h => {
          const li = document.createElement("li");
          li.textContent = `${h.data} - ${h.funcionario} lavou ${h.veiculo}`;
          historicoUl.appendChild(li);
        });

        // Gráfico
        const dataHoje = new Date().toLocaleDateString();
        ["carro", "moto", "caminhao"].forEach((tipo, i) => {
          const count = registros.filter(r => r.veiculo === tipo).length;
          const dataset = grafico.data.datasets[i];
          const idx = grafico.data.labels.indexOf(dataHoje);
          if (idx === -1) {
            grafico.data.labels.push(dataHoje);
            dataset.data.push(count);
          } else {
            dataset.data[idx] = count;
          }
        });
        grafico.update();
      }

      function adicionarRegistro() {
        const funcionario = document.getElementById("funcionario").value.trim();
        const veiculo = document.getElementById("veiculo").value;
        if (!funcionario) return;
        registros.push({ funcionario, veiculo });
        historico.push({ funcionario, veiculo, data: new Date().toLocaleString() });
        document.getElementById("funcionario").value = "";
        atualizarTela();
      }

      function loginDono() {
        const senha = document.getElementById("senhaDono").value;
        if (senha === senhaCorreta) {
          painelDono.style.display = "block";
          loginDonoDiv.style.display = "none";
        } else {
          alert("Senha incorreta!");
        }
      }

      function logoutDono() {
        painelDono.style.display = "none";
        loginDonoDiv.style.display = "block";
      }

      function mostrarAba(aba) {
        document.getElementById("aba-historico").style.display = aba === "historico" ? "block" : "none";
        document.getElementById("aba-grafico").style.display = aba === "grafico" ? "block" : "none";
      }

      // Eventos
      document.getElementById("btnAdicionar").addEventListener("click", adicionarRegistro);
      document.getElementById("btnLoginDono").addEventListener("click", loginDono);
      document.getElementById("btnLogoutDono").addEventListener("click", logoutDono);
      document.getElementById("abaHistoricoBtn").addEventListener("click", () => mostrarAba("historico"));
      document.getElementById("abaGraficoBtn").addEventListener("click", () => mostrarAba("grafico"));
    });
  </script>
</body>
</html>
