<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lava Jato do Di</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header>
    <img src="logo.png" alt="Logo Lava Jato" class="logo">
    <h1>Lava Jato do Di 🚗🧼</h1>
  </header>

  <main>
    <div class="formulario">
      <input type="text" id="funcionario" placeholder="Nome do funcionário">
      <select id="veiculo">
        <option value="carro">Carro</option>
        <option value="moto">Moto</option>
        <option value="caminhao">Caminhão</option>
      </select>
      <button onclick="adicionarRegistro()">Adicionar</button>
    </div>

    <section>
      <h2>Registros de hoje</h2>
      <ul id="listaRegistros"></ul>
    </section>

    <section>
      <h2>Ganhos por funcionário</h2>
      <ul id="listaGanhos"></ul>
    </section>

    <section>
      <h2>Resumo do dia</h2>
      <p id="resumo"></p>
      <button onclick="finalizarDia()">✅ Finalizar dia</button>
    </section>
  </main>

  <!-- Painel do dono -->
  <div id="painelDono" class="painel">
    <div class="painel-header">
      <span>👑 Painel do Dono</span>
      <button onclick="sairPainel()">Sair</button>
    </div>

    <div class="abas">
      <button onclick="abrirAba('registros')">📋 Registros</button>
      <button onclick="abrirAba('ganhos')">💰 Ganhos</button>
      <button onclick="abrirAba('historico')">📅 Histórico</button>
    </div>

    <div id="aba-registros" class="aba-conteudo">
      <ul id="registrosDono"></ul>
    </div>

    <div id="aba-ganhos" class="aba-conteudo" style="display:none;">
      <ul id="ganhosDono"></ul>
    </div>

    <div id="aba-historico" class="aba-conteudo" style="display:none;">
      <ul id="listaHistorico"></ul>
      <canvas id="graficoHistorico"></canvas>
    </div>
  </div>

  <!-- Login do dono -->
  <div id="loginDono" class="login-dono">
    <input type="password" id="senhaDono" placeholder="Senha do dono">
    <button onclick="entrarPainel()">Entrar</button>
  </div>

  <script>
    const valores = { carro: 20, moto: 10, caminhao: 50 };
    const icones = {
      carro: "🚗",
      moto: "🏍️",
      caminhao: "🚚"
    };
    const senhaCorreta = "1234";

    let registros = [];
    let historico = [];
    let chartHistorico = null;

    function adicionarRegistro() {
      const funcionario = document.getElementById("funcionario").value.trim();
      const veiculo = document.getElementById("veiculo").value;

      if (!funcionario) return;

      registros.push({ funcionario, veiculo });
      document.getElementById("funcionario").value = "";
      atualizarTela();
    }

    function atualizarTela() {
      const listaRegistros = document.getElementById("listaRegistros");
      listaRegistros.innerHTML = "";
      registros.forEach(r => {
        const li = document.createElement("li");
        li.textContent = `${r.funcionario} lavou ${r.veiculo} ${icones[r.veiculo]} (+R$ ${valores[r.veiculo]})`;
        listaRegistros.appendChild(li);
      });

      const ganhos = registros.reduce((acc, r) => {
        acc[r.funcionario] = (acc[r.funcionario] || 0) + valores[r.veiculo];
        return acc;
      }, {});

      const listaGanhos = document.getElementById("listaGanhos");
      listaGanhos.innerHTML = "";
      Object.entries(ganhos).forEach(([nome, total]) => {
        const li = document.createElement("li");
        li.textContent = `${nome}: R$ ${total}`;
        listaGanhos.appendChild(li);
      });

      const totalCarros = registros.filter(r => r.veiculo === "carro").length;
      const totalMotos = registros.filter(r => r.veiculo === "moto").length;
      const totalCaminhoes = registros.filter(r => r.veiculo === "caminhao").length;
      const totalGeral = registros.reduce((sum, r) => sum + valores[r.veiculo], 0);

      document.getElementById("resumo").textContent =
        `Carros: ${totalCarros}, Motos: ${totalMotos}, Caminhões: ${totalCaminhoes}, Total do dia: R$ ${totalGeral}`;

      atualizarPainelDono();
    }

    function finalizarDia() {
      if (registros.length === 0) return;
      const totalCarros = registros.filter(r => r.veiculo === "carro").length;
      const totalMotos = registros.filter(r => r.veiculo === "moto").length;
      const totalCaminhoes = registros.filter(r => r.veiculo === "caminhao").length;
      const totalGeral = registros.reduce((sum, r) => sum + valores[r.veiculo], 0);

      historico.push({
        data: new Date().toLocaleDateString("pt-BR"),
        totalCarros,
        totalMotos,
        totalCaminhoes,
        totalGeral
      });

      registros = [];
      atualizarTela();
    }

    function entrarPainel() {
      const senha = document.getElementById("senhaDono").value;
      if (senha === senhaCorreta) {
        document.getElementById("painelDono").style.display = "block";
        document.getElementById("loginDono").style.display = "none";
        atualizarPainelDono();
      } else {
        alert("Senha incorreta!");
      }
    }

    function sairPainel() {
      document.getElementById("painelDono").style.display = "none";
      document.getElementById("loginDono").style.display = "block";
    }

    function abrirAba(aba) {
      document.querySelectorAll(".aba-conteudo").forEach(div => div.style.display = "none");
      document.getElementById("aba-" + aba).style.display = "block";
      if (aba === "historico") atualizarHistorico();
    }

    function atualizarPainelDono() {
      const lista = document.getElementById("registrosDono");
      lista.innerHTML = "";
      registros.forEach(r => {
        const li = document.createElement("li");
        li.textContent = `${r.funcionario} lavou ${r.veiculo} ${icones[r.veiculo]} (+R$ ${valores[r.veiculo]})`;
        lista.appendChild(li);
      });

      const ganhos = registros.reduce((acc, r) => {
        acc[r.funcionario] = (acc[r.funcionario] || 0) + valores[r.veiculo];
        return acc;
      }, {});

      const listaGanhos = document.getElementById("ganhosDono");
      listaGanhos.innerHTML = "";
      Object.entries(ganhos).forEach(([nome, total]) => {
        const li = document.createElement("li");
        li.textContent = `${nome}: R$ ${total}`;
        listaGanhos.appendChild(li);
      });
    }

    function atualizarHistorico() {
      const lista = document.getElementById("listaHistorico");
      lista.innerHTML = "";

      if (historico.length === 0) {
        lista.innerHTML = "<li>Nenhum dia registrado ainda.</li>";
        return;
      }

      historico.forEach(dia => {
        const li = document.createElement("li");
        li.textContent =
          `${dia.data} → Carros: ${dia.totalCarros}, Motos: ${dia.totalMotos}, Caminhões: ${dia.totalCaminhoes}, Total: R$ ${dia.totalGeral}`;
        lista.appendChild(li);
      });

      const ctx = document.getElementById("graficoHistorico").getContext("2d");
      if (chartHistorico) chartHistorico.destroy();

      chartHistorico = new Chart(ctx, {
        type: "bar",
        data: {
          labels: historico.map(d => d.data),
          datasets: [{
            label: "Arrecadação por dia (R$)",
            data: historico.map(d => d.totalGeral),
            backgroundColor: "rgba(0,123,255,0.7)",
            borderColor: "rgba(0,123,255,1)",
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            title: { display: true, text: "Histórico de arrecadação" }
          },
          scales: { y: { beginAtZero: true } }
        }
      });
    }
  </script>
</body>
</html>
